"""TRG

Reference:

temp: temperature
T: UniTensor T

Ref:
* https://tensornetwork.org/trg/
"""
import cytnx
import numpy as np

# zero external field
print("#"*80)
print("(TRG) 2D Ising model, zero external field")
print("#"*80)
temp = 1.
print("(TRG) Constructing W")
W = np.array([[+np.exp(+1/temp), +np.exp(-1/temp)],
              [+np.exp(-1/temp), +np.exp(+1/temp)]])

print("(TRG) Constructing M")
M = np.array([[+np.sqrt(np.cosh(+1/temp)), +np.sqrt(np.sinh(+1/temp))],
              [+np.sqrt(np.cosh(+1/temp)), -np.sqrt(np.sinh(+1/temp))]])

print("(TRG) Checking if W-M@Md=0")
print(np.linalg.norm(W-M@M.transpose()))

# tensor Name : T
# tensor Rank : 4
# block_form  : False
# is_diag     : False
# on device   : cytnx device: CPU
#              ---------
#             /         \
#    y_i ____| 2     2 |____ x_o
#             |         
#    x_i ____| 2     2 |____ y_o
#             \         /
#              ---------print("(TRG) Constructing T")
bd = cytnx.Bond(2)
T = cytnx.UniTensor([bd,bd,bd,bd], rowrank=2).set_name("T").relabel(["y_i","x_i","x_o","y_o"])
T.print_diagram()
for y_i in range(2):
    for x_i in range(2):
        for x_o in range(2):
            for y_o in range(2):
                T[y_i,x_i,x_o,y_o] = M[0,y_i]*M[0,x_i]*M[0,x_o]*M[0,y_o] + M[1,y_i]*M[1,x_i]*M[1,x_o]*M[1,y_o]
print(T)
# [[[[4.76220e+00 0.00000e+00 ]
#    [0.00000e+00 3.62686e+00 ]]
#   [[0.00000e+00 3.62686e+00 ]
#    [3.62686e+00 0.00000e+00 ]]]
#  [[[0.00000e+00 3.62686e+00 ]
#    [3.62686e+00 0.00000e+00 ]]
#   [[3.62686e+00 0.00000e+00 ]
#    [0.00000e+00 2.76220e+00 ]]]]
print(T.get_block().reshape(4,4))
# [[4.76220e+00 0.00000e+00 0.00000e+00 3.62686e+00 ]
#  [0.00000e+00 3.62686e+00 3.62686e+00 0.00000e+00 ]
#  [0.00000e+00 3.62686e+00 3.62686e+00 0.00000e+00 ]
#  [3.62686e+00 0.00000e+00 0.00000e+00 2.76220e+00 ]]

# two different trace have the same result due to symmetry
trT = T.clone().Trace_("x_i","x_o").Trace_("y_i","y_o").set_name("trT")
trT.print_diagram()
trT = trT[0].item()
print("(TRG) trT={}".format(trT))

trT = T.clone().Trace_("x_i","y_i").Trace_("x_o","y_o").set_name("trT")
trT.print_diagram()
trT = trT[0].item()
print("(TRG) trT={}".format(trT))

# tensor Name : T_arrow
# tensor Rank : 4
# block_form  : False
# is_diag     : False
# on device   : cytnx device: CPU
# braket_form : True
#          row           col
#             -----------
#             |         |
#    y_i  -->| 2     2 |-->  x_o
#             |         |
#    x_i  -->| 2     2 |-->  y_o
#             |         |
#             -----------
print("(TRG) Constructing T_arrow")
bd_i = cytnx.Bond(2, cytnx.BD_IN)
bd_o = cytnx.Bond(2, cytnx.BD_OUT)
T_arrow = cytnx.UniTensor([bd_i,bd_i,bd_o,bd_o], rowrank=2).set_name("T_arrow").relabel(["y_i","x_i","x_o","y_o"])
T_arrow.print_diagram()
for y_i in range(2):
    for x_i in range(2):
        for x_o in range(2):
            for y_o in range(2):
                T_arrow[y_i,x_i,x_o,y_o] = M[0,y_i]*M[0,x_i]*M[0,x_o]*M[0,y_o] + M[1,y_i]*M[1,x_i]*M[1,x_o]*M[1,y_o]

print(T_arrow)
print(T_arrow.get_block().reshape(4,4))

# this one works
trT = T_arrow.clone().Trace_("x_i","x_o").Trace_("y_i","y_o").set_name("trT")
trT.print_diagram()
trT = trT[0].item()
print("(TRG) trT={}".format(trT))
# this one should fail du to the direction of the bond
try:
    trT = T_arrow.clone().Trace_("x_i","y_i").Trace_("x_o","y_o").set_name("trT")
    trT.print_diagram()
    trT = trT[0].item()
    print("(TRG) trT={}".format(trT))
except:
    print("(TRG) Fail!")

# For a block
# AB
# CD 
# init: 
# ยทยทยทยทยทยทยทยทยทยท๐ฒยท๐ณยทยทยทยทยทยทยทยทยทยทยทยทยทยท๐ฒยท๐ณยทยทยทยทยทยทยทยทยทยทยทยทยท๐ฒยท๐ณยทยทยทยทยทยทยทยทยทยทยทยทยทยท๐ฒยท๐ณยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยท๐ฐยท๐ฑยทยทยทยทยทยทยทยทยทยทยทยทยทยท๐ฐยท๐ฑยทยทยทยทยทยทยทยทยทยทยทยทยท๐ฐยท๐ฑยทยทยทยทยทยทยทยทยทยทยทยทยทยท๐ฐยท๐ฑยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทโฑยทยทยทยทยทโฒยทยทยทยทยทยทยทยทยทยทยทโฑยทยทยทยทยทโฒยทยทยทยทยทยทยทยทยทโฑยทยทยทยทยทโฒยทยทยทยทยทยทยทยทยทยทยทยทโฑยทยทยทยทยทโฒยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยท๐ฐยทยทยทยทยทยทยท๐ฑยทยทยทยทยทยทยทยท๐ฐยทยทยทยทยทยทยท๐ฑยทยทยทยทยทยทยท๐ฐยทยทยทยทยทยทยท๐ฑยทยทยทยทยทยทยท๐ฐยทยทยทยทยทยทยท๐ฑยทยทยทยทยทยทยทยทยทยท
# โฒยทยทยทยทยทโฑยทยทยทยทยทยทยทยทยทยทยทโฒยทยทยทยทยทโฑยทยทยทยทยทยทยทยทยทยทโฒยทยทยทยทยทโฑยทยทยทยทยทยทยทยทยทยทยทโฒยทยทยทยทยทโฑยทยทยทยทยทยทยทยทยทยทยทโฒยทยทยทยทยทยทยทยท
# ยท๐ฑยท๐ฐยทยทยทยทยทยทยทยทยทยทยทยทยทยท๐ฑยท๐ฐยทยทยทยทยทยทยทยทยทยทยทยทยทยท๐ฑยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท๐ฑยท๐ฐยทยทยทยทยทยทยทยทยทยทยทยทยท๐ฑยท๐ฐยทยทยทยท
# ยท๐ณยท๐ฒยทยทยทยทยทยทยทยทยทยทยทยทยทยท๐ณยท๐ฒยทยทยทยทยทยทยทยทยทยทยทยทยทยท๐ณยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท๐ณยท๐ฒยทยทยทยทยทยทยทยทยทยทยทยทยท๐ณยท๐ฒยทยทยทยท
# โฑยทยทยทยทยทโฒยทยทยทยทยทยทยทยทยทยทยทโฑยทยทยทยทยทโฒยทยทยทยทยทยทยทยทยทยทยทโฑยทยทยทยทยทโฒยทยทยทยทยทยทยทยทยทยทโฑยทยทยทยทยทโฒยทยทยทยทยทยทยทยทยทยทยทโฑยทยทยทยทยทโฒยทยท
# ยทยทยทยทยทยทยท๐ฒยทยทยทยทยทยทยท๐ณยทยทยทยทยทยทยทยท๐ฒยทยทยทยทยทยทยท๐ณยทยทยทยทยทยทยท๐ฒยทยทยทยทยทยทยท๐ณยทยทยทยทยทยทยท๐ฒยทยทยทยทยทยทยท๐ณยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทโฒยทยทยทยทยทโฑยทยทยทยทยทยทยทยทยทยทยทโฒยทยทยทยทยทโฑยทยทยทยทยทยทยทยทยทยทยทโฒยทยทยทยทยทโฑยทยทยทยทยทยทยทยทยทยทโฒยทยทยทยทยทโฑยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยท๐ฒยท๐ณยทยทยทยทยทยทยทยทยทยทยทยทยทยท๐ฒยท๐ณยทยทยทยทยทยทยทยทยทยทยทยทยท๐ฒยท๐ณยทยทยทยทยทยทยทยทยทยทยทยทยท๐ฒยท๐ณยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยท๐ฐยท๐ฑยทยทยทยทยทยทยทยทยทยทยทยทยทยท๐ฐยท๐ฑยทยทยทยทยทยทยทยทยทยทยทยทยท๐ฐยท๐ฑยทยทยทยทยทยทยทยทยทยทยทยทยท๐ฐยท๐ฑยทยทยทยทยทยทยทยทยทยทยทยทยท





# SVD
print("(TRG) SVD")
# ยทยทยทยทยทยทยทy_iยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทy_iยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทy_iยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทโโโดโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโโโดโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโโโดโโยทยทยทยทยทยทยทยทยทยทยทยทยท
# x_iยทโโถโค T โโถโยทx_oยท=ยทx_iยทโโถโคUL โยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโUR โโถโยทx_oยทยทยทยทยทยทยท
# ยทยทยทยทยทยทโโโฌโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโโโโโขยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโฅโโโโยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโฒยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโฑยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทUL_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทUR_iยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทy_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทDR_iยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทDL_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโฒยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโฑยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโขโโโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโโโโโฅยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโDR โโโถโยทx_oยท=ยทx_iโโถโคDLยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโโโฌโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโโโฌโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทy_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทy_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# T-->UL @ DR
print("(TRG) T-->UL @ DR")
T.print_diagram()
S , U , Vdag = cytnx.linalg.Svd(T)
S_sqrt = cytnx.linalg.Pow(S,0.5).set_name("S_sqrt")
UL = cytnx.Contract(U, S_sqrt).set_name("UL").relabel(["y_i","x_i","UL_o"])
DR = cytnx.Contract(S_sqrt, Vdag).set_name("DR").relabel(["DR_i","x_o","y_o"])

def T_to_UL_DR(T):
    S , U , Vdag = cytnx.linalg.Svd(T)
    S_sqrt = cytnx.linalg.Pow(S,0.5).set_name("S_sqrt")
    S_sqrt.print_diagram()
    UL = cytnx.Contract(U, S_sqrt).set_name("UL").relabel(["y_i","x_i","UL_o"])
    DR = cytnx.Contract(S_sqrt, Vdag).set_name("DR").relabel(["DR_i","x_o","y_o"])
    return UL, DR

T_UL, T_DR = T_to_UL_DR(T)
print((T_UL-UL).Norm())
print((T_DR-DR).Norm())

# T-->DL @ UR
print("(TRG) T-->DL @ UR")
T.permute(["x_i","y_o","y_i","x_o"]).print_diagram()
S , U , Vdag = cytnx.linalg.Svd(T.permute(["x_i","y_o","y_i","x_o"]))
S_sqrt = cytnx.linalg.Pow(S,0.5).set_name("S_sqrt")
DL = cytnx.Contract(U, S_sqrt).set_name("DL").relabel(["x_i","y_o","DL_o"])
UR = cytnx.Contract(S_sqrt, Vdag).set_name("UR").relabel(["UR_i","y_i","x_o"])

def T_to_DL_UR(T):
    T.permute(["x_i","y_o","y_i","x_o"]).print_diagram()
    S , U , Vdag = cytnx.linalg.Svd(T.permute(["x_i","y_o","y_i","x_o"]))
    S_sqrt = cytnx.linalg.Pow(S,0.5).set_name("S_sqrt")
    DL = cytnx.Contract(U, S_sqrt).set_name("DL").relabel(["x_i","y_o","DL_o"])
    UR = cytnx.Contract(S_sqrt, Vdag).set_name("UR").relabel(["UR_i","y_i","x_o"])
    return DL, UR
    

T_DL, T_UR = T_to_DL_UR(T)
print((T_DL-DL).Norm())
print((T_UR-UR).Norm())



# ยทยทยทยทยทยทยทy_iยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทy_iยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทโโโดโโยทยทยทยทยทยทยทยทยทยทยทยทยทโโโดโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# x_iยทโโถโค T โโถโยทx_oโx_iยทโโถโค T โโถโยทx_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทโโโฌโโยทยทยทยทยทยทยทยทยทยทยทยทยทโโโฌโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทy_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทy_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทy_iยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทy_iยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทโโโดโโยทยทยทยทยทยทยทยทยทยทยทยทยทโโโดโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# x_iยทโโถโค T โโถโยทx_oโx_iยทโโถโค T โโถโยทx_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทโโโฌโโยทยทยทยทยทยทยทยทยทยทยทยทยทโโโฌโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทy_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทy_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท

# ยทยทยทยทยทยทยทy_iยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทy_iยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทโโโดโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโโโดโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# x_iยทโโถโคUL โยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโUR โโถยทโx_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทโโโโโขยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโฅโโโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทโฒยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโฑยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทUL_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทUR_iยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทDR_iยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทDL_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทโฒยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโฑยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทยทโขโโโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทโโโโโฅยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทยทโDR โโโถโยทx_oโx_iยทโโถโคDL โยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทยทโโโฌโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทโโโฌโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทy_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทy_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทy_iยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทy_iยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทยทโโโดโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทโโโดโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทยทโUR โโโถโยทx_oโx_iยทโโถโคUL โยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทยทโฅโโโโยทยทยทยทยทยทยทยท ยทยทยทยทยทโโโโโขยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทยทยทโฑยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโฒยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทUR_iยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทUL_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทDL_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทDR_iยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทยทยทยทโฑยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโฒยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทโโโโโฅยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโขโโโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# x_iยทโโถโคDL โยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโDR โโถโยทx_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทโโโฌโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโโโฌโโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโผยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทโยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
# ยทยทยทยทยทยทยทy_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทy_oยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท


# net = cytnx.Network()
# net.FromString(["DR: DR_i, xoxi_u, yoyi_l", \
#                 "DL: DL_o, xoxi_u, yoyi_r", \
#                 "UR: UR_i, xoxi_d, yoyi_l", \
#                 "UL: UL_o, xoxi_d, yoyi_r", \
#                 "TOUT: DR_i, UR_i, DL_o, UL_o"])
# print(net)
# # net.PutUniTensor("DR", DR)
# net.PutUniTensor("DR", DR, ["DR_i","x_o","y_o"])
# net.PutUniTensor("DL", DL, ["DL_o","x_i","y_o"])
# net.PutUniTensor("UR", UR, ["UR_i","x_o","y_i"])
# net.PutUniTensor("UL", UL, ["UL_o","x_i","y_i"])
# print(net)
# Tout1 = net.Launch()
# Tout1.print_diagram()

# net = cytnx.Network()
# net.FromString(["DR: DR_i, DR_xo-DL_xi, DR_yo-UR_yi", \
#                 "DL: DL_o, DR_xo-DL_xi, DL_yo-UL_yi", \
#                 "UR: UR_i, UR_xo-UL_xi, DR_yo-UR_yi", \
#                 "UL: UL_o, UR_xo-UL_xi, DL_yo-UL_yi", \
#                 "TOUT: DR_i, UR_i, DL_o, UL_o"])
# print(net)
# # net.PutUniTensor("DR", DR)
# net.PutUniTensor("DR", DR, ["DR_i","x_o","y_o"])
# net.PutUniTensor("DL", DL, ["DL_o","x_i","y_o"])
# net.PutUniTensor("UR", UR, ["UR_i","x_o","y_i"])
# net.PutUniTensor("UL", UL, ["UL_o","x_i","y_i"])
# print(net)
# Tout2 = net.Launch()
# Tout2.print_diagram()

# diff = Tout1-Tout2
# print(diff.Norm())
# print(type(diff))

# Main
# if __name__ == "__main__":
#     print("(TRG) TRG, 2D Ising model")
